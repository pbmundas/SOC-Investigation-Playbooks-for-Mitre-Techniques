playbook_name: "T1056.002 - GUI Input Capture Detection: Investigation & Triage"
tactic: "Collection"
technique_id: "T1056.002"
technique_name: "GUI Input Capture"
description: >
  Detects adversaries capturing user input through GUI interaction methods such as screen scraping or GUI automation tools.

investigation_steps:
  - step_number: 1
    title: "Detect GUI Automation or Screen Scraping Tools"
    description: >
      Identify use of tools or processes that capture GUI inputs or automate user interactions.
    checklist:
      - "Are there unusual executions of GUI automation software?"
      - "Is screen scraping software or suspicious DLL injection detected?"
    data_sources:
      - "Process creation logs"
      - "DLL injection monitoring"
      - "EDR telemetry"

  - step_number: 2
    title: "Monitor Creation of GUI Capture Artifacts"
    description: >
      Detect files or logs generated by GUI input capture tools.
    checklist:
      - "Are GUI capture logs or screenshots stored in suspicious locations?"
      - "Is there network traffic related to GUI input data transmission?"
    data_sources:
      - "File system logs"
      - "Network traffic"

  - step_number: 3
    title: "Correlate GUI Input Capture with Other Suspicious Behavior"
    description: >
      Link GUI input capture activity with credential theft, lateral movement, or data exfiltration.
    checklist:
      - "Is GUI capture followed by credential access?"
      - "Are remote sessions established after GUI capture?"
    data_sources:
      - "Authentication logs"
      - "Network session logs"

triage_labels:
  - severity_levels:
      - "Low: Authorized GUI automation or accessibility tools."
      - "Medium: Suspicious GUI capture without confirmed malicious activity."
      - "High: Malicious GUI input capture related to espionage or credential theft."
  - confidence_levels:
      - "High: Confirmed GUI input capture followed by malicious activity."
      - "Medium: Detection of GUI capture tools/processes."
      - "Low: Legitimate GUI automation."

ioc_types:
  - "Execution of screen scraping or GUI automation software"
  - "Creation of GUI input capture logs or screenshots"
  - "Suspicious remote session after GUI input capture"

queries/examples:
  - name: "Detect GUI Automation Tool Execution"
    query: >
      process.name IN ("AutoIt.exe", "SikuliX.exe", "ScreenScraper.exe")

  - name: "Suspicious DLL Injection for GUI Capture"
    query: >
      process.injected_dll_name MATCHES ("*gui_capture*.dll")

automation_hooks:
  - "Alert on unauthorized GUI automation or screen scraping tools."
  - "Block network traffic containing GUI input capture data."
  - "Notify security team for detailed investigation."

analyst_guidance:
  - "Verify if GUI input capture tools are authorized."
  - "Review timing and context of capture activities."
  - "Investigate subsequent credential access or lateral movement."

reference_links:
  - "https://attack.mitre.org/techniques/T1056/002/"
  - "https://www.sans.org/white-papers/398/"

review_cycle: "Quarterly or upon detection of suspicious GUI input capture"
