playbook_name: "T1113 - Screen Capture Detection: Investigation & Triage"
tactic: "Collection"
technique_id: "T1113"
technique_name: "Screen Capture"
description: >
  Detects adversaries capturing screenshots of user desktops to gather information during collection phase.

investigation_steps:
  - step_number: 1
    title: "Identify Screen Capture Tool Execution"
    description: >
      Detect processes or utilities used for screen capturing (e.g., snipping tool, screencapture, third-party tools).
    checklist:
      - "Are screen capture tools executed by unusual users or at suspicious times?"
      - "Are there unsigned or unknown screen capture utilities running?"
    data_sources:
      - "Process creation logs"
      - "File execution monitoring"

  - step_number: 2
    title: "Monitor Creation of Screenshot Files"
    description: >
      Detect creation of image files typically generated by screen capture tools (e.g., .png, .jpg).
    checklist:
      - "Are screenshots saved in uncommon locations?"
      - "Are files created in quick succession or large volumes?"
    data_sources:
      - "File system monitoring"
      - "Process monitoring"

  - step_number: 3
    title: "Correlate Screen Capture Activity with Other Malicious Behavior"
    description: >
      Look for relationship between screen captures and other suspicious activities such as credential access or data exfiltration.
    checklist:
      - "Is screen capture followed by data staging or exfiltration?"
      - "Are involved users or processes anomalous?"
    data_sources:
      - "Network logs"
      - "User behavior analytics"

triage_labels:
  - severity_levels:
      - "Low: Screen captures for legitimate purposes."
      - "Medium: Suspicious screen captures without further malicious activity."
      - "High: Screen capture activity linked to data theft or espionage."
  - confidence_levels:
      - "High: Verified screen capture followed by exfiltration."
      - "Medium: Detection of unusual screen capture tool usage."
      - "Low: Normal screen capture usage."

ioc_types:
  - "Execution of screen capture utilities"
  - "Creation of image files with screen capture metadata"
  - "Suspicious timing or volume of screenshot files"

queries/examples:
  - name: "Detect Screen Capture Tool Execution"
    query: >
      process.name IN ("SnippingTool.exe", "screencapture", "screenshot") AND
      user.name NOT IN ("admin", "support")

  - name: "Screenshot File Creation"
    query: >
      file.extension IN (".png", ".jpg", ".bmp") AND
      file.creation_time > now() - 1h

automation_hooks:
  - "Alert on screen capture tool execution by suspicious users."
  - "Block or quarantine suspicious screenshot files."
  - "Notify security team for investigation."

analyst_guidance:
  - "Determine if screen captures are authorized."
  - "Review user activity and context."
  - "Check for related data access or exfiltration activity."

reference_links:
  - "https://attack.mitre.org/techniques/T1113/"
  - "https://www.sans.org/white-papers/398/"

review_cycle: "Quarterly or after suspicious screen capture detection"
