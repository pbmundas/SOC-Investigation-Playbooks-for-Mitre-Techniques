playbook_name: "T1068 - Exploitation for Privilege Escalation Detection: Investigation & Triage"
tactic: "Privilege Escalation"
technique_id: "T1068"
technique_name: "Exploitation for Privilege Escalation"
description: >
  Detect attempts to exploit software vulnerabilities to elevate privileges.

investigation_steps:
  - step_number: 1
    title: "Identify Known Exploit Indicators"
    description: >
      Detect signatures or behaviors associated with privilege escalation exploits.
    checklist:
      - "Are known CVEs being exploited (e.g., via Metasploit, PowerSploit)?"
      - "Are there abnormal calls to kernel-level functions or APIs?"
    data_sources:
      - "Exploit detection signatures"
      - "Sysmon or EDR process telemetry"

  - step_number: 2
    title: "Check for Unusual Privilege Changes"
    description: >
      Confirm if privilege levels have changed unexpectedly.
    checklist:
      - "Did a low-privilege user spawn SYSTEM processes?"
      - "Are parent-child process relationships abnormal?"
    data_sources:
      - "Process creation logs"
      - "User account activity logs"

  - step_number: 3
    title: "Contain and Patch"
    description: >
      Isolate affected endpoints and validate patch levels.
    checklist:
      - "Is the system missing critical patches?"
      - "Is rollback or host isolation needed?"
    data_sources:
      - "Vulnerability scanners"
      - "IR platform"

triage_labels:
  - severity_levels:
      - "Low: Reconnaissance or failed attempts."
      - "Medium: Suspicious exploit patterns."
      - "High: Confirmed privilege escalation."
  - confidence_levels:
      - "High: CVE-specific IOC detected."
      - "Medium: Kernel API misuse."
      - "Low: Anomalous behavior without IOC."

ioc_types:
  - "CVE IDs"
  - "Exploit tool artifacts"
  - "Kernel API usage patterns"

queries/examples:
  - name: "Privilege Escalation Attempt"
    query: >
      (event.process.command_line:*exploit* OR event.process.name:*exploit*) AND
      user.privilege:"User" AND process.privilege:"SYSTEM"

  - name: "Unexpected SYSTEM-Level Process"
    query: >
      process.parent.user.name:!="SYSTEM" AND
      process.user.name:"SYSTEM"

automation_hooks:
  - "Alert on kernel exploit attempts."
  - "Initiate auto-containment on SYSTEM privilege elevation."
  - "Trigger patch level check."

analyst_guidance:
  - "Review CVE timelines and patch history."
  - "Validate process behavior with threat intelligence."
  - "Engage vulnerability management team."

reference_links:
  - "https://attack.mitre.org/techniques/T1068/"
  - "https://nvd.nist.gov/"

review_cycle: "Monthly or when new privilege escalation exploits are discovered"