playbook_name: "T1110.004 - Exploitation for Credential Access Detection: Investigation & Triage"
tactic: "Credential Access"
technique_id: "T1110.004"
technique_name: "Exploitation for Credential Access"
description: >
  Detects exploitation of software vulnerabilities to obtain credentials or escalate privileges.

investigation_steps:
  - step_number: 1
    title: "Identify Exploit Attempts on Known Vulnerabilities"
    description: >
      Monitor for attempts to exploit software vulnerabilities related to credential access.
    checklist:
      - "Are there exploitation attempts matching CVEs affecting authentication or credential stores?"
      - "Are exploit payloads or shellcode detected?"
    data_sources:
      - "IDS/IPS logs"
      - "Endpoint detection logs"

  - step_number: 2
    title: "Detect Suspicious Process or Command Execution"
    description: >
      Look for processes spawned or commands executed that indicate credential theft or privilege escalation.
    checklist:
      - "Are there abnormal commands related to credential dumping?"
      - "Is there use of tools like Mimikatz or custom exploits?"
    data_sources:
      - "Process creation logs"
      - "EDR telemetry"

  - step_number: 3
    title: "Correlate with Credential Access or Privilege Escalation"
    description: >
      Determine if exploitation activity led to actual credential theft or privilege gains.
    checklist:
      - "Are there new credentials in memory or on disk?"
      - "Is there abnormal privilege escalation activity?"
    data_sources:
      - "Memory forensics"
      - "Security event logs"

triage_labels:
  - severity_levels:
      - "Low: Exploit attempt detected but no credential access."
      - "Medium: Successful exploitation but no confirmed credential theft."
      - "High: Confirmed credential theft or privilege escalation."
  - confidence_levels:
      - "High: Verified exploitation and credential theft."
      - "Medium: Exploit signs without full confirmation."
      - "Low: Potential exploit without clear impact."

ioc_types:
  - "Exploit attempts for known CVEs"
  - "Execution of credential dumping tools"
  - "Unusual privilege escalation events"

queries/examples:
  - name: "Detect Exploit Attempts"
    query: >
      network.signature == "known_exploit_CVE" OR
      process.command_line CONTAINS ("mimikatz", "procdump")

  - name: "Credential Dumping Process Execution"
    query: >
      process.name IN ("mimikatz.exe", "procdump.exe", "powershell.exe") AND
      command_line MATCHES ("sekurlsa|lsadump|credhist")

automation_hooks:
  - "Isolate affected hosts immediately."
  - "Alert SOC and incident response teams."
  - "Initiate credential rotation and incident handling."

analyst_guidance:
  - "Validate exploitation indicators with endpoint data."
  - "Perform forensic analysis to confirm credential theft."
  - "Recommend patching vulnerable systems promptly."

reference_links:
  - "https://attack.mitre.org/techniques/T1110/004/"
  - "https://docs.microsoft.com/en-us/security-updates"

review_cycle: "After each exploitation alert or quarterly"
